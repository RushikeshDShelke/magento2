<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
 namespace Topefekt\Magesms\Model; use Magento\Framework\Data\Collection\AbstractDb; use Magento\Framework\Model\AbstractModel; use Magento\Framework\Model\Context; use Magento\Framework\Registry; use Magento\Framework\Model\ResourceModel\AbstractResource; use Magento\Sales\Model\ResourceModel\Order\Status\CollectionFactory; use Topefekt\Magesms\Helper\Data; class Hooks extends AbstractModel { public static $groups = array( 'order_status' => 0, 'order' => 1, 'account' => 2, 'product' => 3, 'contactform' => 4 ); protected $_helper; protected $statusCollectionFactory; protected $_profile; protected $_request; public function __construct(Context $i31cc913adc2717e2346d503153c97449098831aa, Registry $ie9fe5cdc9fc7093987f4d41ad4cae3554e64e17b, Data $i0d09b2a4f282150bf47b02f9f3d82586fe313844, CollectionFactory $i8c32f8f7817f74b7ade75b53e108fadb6b616a07, Smsprofile $i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18, \Magento\Framework\App\RequestInterface $ib2c014c384e400e98e6977efa41c20d14e2c7dea, AbstractResource $ie1939956d7f2b426b1f98ab49f12f1d271da85c2 = null, AbstractDb $ib0dfcb3a2fe0ac5af091a318af6a161d665cc0cd = null, array $ia61712c27ea241bd7a543dc2b02ea572274d0322 = []) { parent::__construct($i31cc913adc2717e2346d503153c97449098831aa, $ie9fe5cdc9fc7093987f4d41ad4cae3554e64e17b, $ie1939956d7f2b426b1f98ab49f12f1d271da85c2, $ib0dfcb3a2fe0ac5af091a318af6a161d665cc0cd, $ia61712c27ea241bd7a543dc2b02ea572274d0322); $this->_helper = $i0d09b2a4f282150bf47b02f9f3d82586fe313844; $this->statusCollectionFactory = $i8c32f8f7817f74b7ade75b53e108fadb6b616a07; $this->_profile = $i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18; $this->_request = $ib2c014c384e400e98e6977efa41c20d14e2c7dea; } public function _construct() { $this->_init('Topefekt\Magesms\Model\ResourceModel\Hooks'); } public function getHooks($group, $i30f20aafde612a957f7f966cb5b85e35782bc88a, $i7137e40370cf1c5ccf937060891613788203e2d6 = 'default', $i2d8fb6b6f17ec9aa17899ea311cc26bc493cd9a2 = false) { $if739aceffec69fa2733946a3d319defaa354082d = []; if (isset(self::$groups[$group]) && $group != 'order_status') { $if739aceffec69fa2733946a3d319defaa354082d = $this->getCollection() ->addFieldToFilter('lang', $this->_helper->getConfig('magesms/template/language')) ->addFieldToFilter('owner', ['neq'=>1]) ->addFieldToFilter('group_type', self::$groups[$group]); if (is_array($i2d8fb6b6f17ec9aa17899ea311cc26bc493cd9a2) && $i2d8fb6b6f17ec9aa17899ea311cc26bc493cd9a2) { foreach ($i2d8fb6b6f17ec9aa17899ea311cc26bc493cd9a2 as $i2bd9743336318d0e14be0600c9129730279505dd=>$iba20acc78644ac0e9cd48ea35d8ad03b058f6b5a) { $if739aceffec69fa2733946a3d319defaa354082d->addFieldToFilter($i2bd9743336318d0e14be0600c9129730279505dd, $iba20acc78644ac0e9cd48ea35d8ad03b058f6b5a); } } else { $if739aceffec69fa2733946a3d319defaa354082d->addFieldToFilter('system', 1); } } elseif (isset(self::$groups[$group])) { $i5aea14ef53aca1d424d64d1e1000254f9eefa3e4 = new \Magento\Framework\Stdlib\StringUtils(); $i42ee48f418943c9662de0976069476c7dc8f620d = $this->getCollection() ->addFieldToFilter('lang', $this->_helper->getConfig('magesms/template/language')) ->addFieldToFilter('owner', ['neq'=>1]) ->addFieldToFilter('system', 1) ->addFieldToFilter('group_type', self::$groups[$group]) ->getFirstItem(); $id09e842bda9623afdb1b69812abe0b86eaf039c9 = $this->statusCollectionFactory->create(); foreach($id09e842bda9623afdb1b69812abe0b86eaf039c9 as $i712821c3a64ae4a252ded9f3deaaddb6e942d985) { $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05 = clone($i42ee48f418943c9662de0976069476c7dc8f620d); $i0bd865ed0ae1ae72e839b8c033a4c0f7d84122b5 = __($i712821c3a64ae4a252ded9f3deaaddb6e942d985->getLabel()); $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05->setTemplate(str_replace('{{order_status_name}}', $i0bd865ed0ae1ae72e839b8c033a4c0f7d84122b5, $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05->getTemplate())); $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05->setTemplateCustomer(str_replace('{{order_status_name}}', $i0bd865ed0ae1ae72e839b8c033a4c0f7d84122b5, $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05->getTemplateCustomer())); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = $i712821c3a64ae4a252ded9f3deaaddb6e942d985->getStatus(); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = preg_replace('/[^a-zA-Z0-9_]/', '_', $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = preg_replace('/^([^a-zA-Z])/', 'x$1', $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5); $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05->setName('orderStatus'.$i5aea14ef53aca1d424d64d1e1000254f9eefa3e4->upperCaseWords($ia0b4e748647d3e52f7c9741d5f659711a2db6dc5, '_', '')); $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05->setStatusName($i712821c3a64ae4a252ded9f3deaaddb6e942d985->getLabel()); $if739aceffec69fa2733946a3d319defaa354082d[] = $i35f7502d936f0fb94b528aa6d4fbaca3f779fa05; } } $ia61712c27ea241bd7a543dc2b02ea572274d0322 = []; foreach($if739aceffec69fa2733946a3d319defaa354082d as $i42ee48f418943c9662de0976069476c7dc8f620d) { $ia61712c27ea241bd7a543dc2b02ea572274d0322[$i42ee48f418943c9662de0976069476c7dc8f620d->getName()] = $i42ee48f418943c9662de0976069476c7dc8f620d; } $ie49438f91abd0c7823066b1fc059270d78ccd75b = \Magento\Framework\App\ObjectManager::getInstance(); $i1ddb77d41f3678bb92f39c5c4d47aa6e58d4b89e = $ie49438f91abd0c7823066b1fc059270d78ccd75b->get('Topefekt\Magesms\Model\Hooks\\'.ucwords($i30f20aafde612a957f7f966cb5b85e35782bc88a))->getCollection(); if ($i30f20aafde612a957f7f966cb5b85e35782bc88a == 'customers') $i1ddb77d41f3678bb92f39c5c4d47aa6e58d4b89e->addFieldToFilter('mutation', $i7137e40370cf1c5ccf937060891613788203e2d6); if ($i1ddb77d41f3678bb92f39c5c4d47aa6e58d4b89e->count()) { foreach($i1ddb77d41f3678bb92f39c5c4d47aa6e58d4b89e as $i4df015c4c10bbcf1d38137f3659b01221d2dc076) { $i670253c23c6fcba76bc4256a88fdd8fbc1041039 = $i4df015c4c10bbcf1d38137f3659b01221d2dc076->getName(); if (isset($ia61712c27ea241bd7a543dc2b02ea572274d0322[$i670253c23c6fcba76bc4256a88fdd8fbc1041039])) { $ia61712c27ea241bd7a543dc2b02ea572274d0322[$i670253c23c6fcba76bc4256a88fdd8fbc1041039]->setSmstext($i4df015c4c10bbcf1d38137f3659b01221d2dc076->getSmstext()); if ($i30f20aafde612a957f7f966cb5b85e35782bc88a == 'admins') { $ia61712c27ea241bd7a543dc2b02ea572274d0322[$i670253c23c6fcba76bc4256a88fdd8fbc1041039][$i4df015c4c10bbcf1d38137f3659b01221d2dc076->getAdminId().'_'.$i4df015c4c10bbcf1d38137f3659b01221d2dc076->getStoreGroupId()] = 1; $ia61712c27ea241bd7a543dc2b02ea572274d0322[$i670253c23c6fcba76bc4256a88fdd8fbc1041039]->setActive(1); } else { $ia61712c27ea241bd7a543dc2b02ea572274d0322[$i670253c23c6fcba76bc4256a88fdd8fbc1041039]->setActive($i4df015c4c10bbcf1d38137f3659b01221d2dc076->getActive()); } } } } return $ia61712c27ea241bd7a543dc2b02ea572274d0322; } public function send($i41496536c6b29c24b90c374d9fc25143f114dc9a, $i5e65dd16263683749d16a84171f719e768ed14b5, $i9ead6d05bd4aaf6513f7229d48e9996fa59d638e = false) { $i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18 = $this->_profile; if ($i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18->user->getUser()) { $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e = \Magento\Framework\App\ObjectManager::getInstance(); $i06a381e12f304723bef83828539567b279a48b64 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Magento\Store\Model\StoreManagerInterface::class); $i589c2cccd18de711ec5e779b98b9f98d0347a925 = $i06a381e12f304723bef83828539567b279a48b64->getStore()->getGroupId(); if (!$i589c2cccd18de711ec5e779b98b9f98d0347a925 && $i5e65dd16263683749d16a84171f719e768ed14b5->hasStoreId()) { $i589c2cccd18de711ec5e779b98b9f98d0347a925 = $i06a381e12f304723bef83828539567b279a48b64->getStore($i5e65dd16263683749d16a84171f719e768ed14b5->getStoreId())->getGroupId(); } if ($i5e65dd16263683749d16a84171f719e768ed14b5->getStore()) $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66 = $i5e65dd16263683749d16a84171f719e768ed14b5->getStore()->getId(); elseif ($i06a381e12f304723bef83828539567b279a48b64->getStore()) $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66 = $i06a381e12f304723bef83828539567b279a48b64->getStore()->getStoreId(); else $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66 = null; if (!$this->_helper->isActive($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)) return $this; if ($this->_registry->registry('magesms_store_id')) $this->_registry->unregister('magesms_store_id'); $this->_registry->register('magesms_store_id', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66, true); $ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\ResourceModel\Hooks\Admins\Collection::class); $ice709f1220fec1ada7d520fc8388dda967c39d87 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Magento\Backend\Model\Session::class); if ($i589c2cccd18de711ec5e779b98b9f98d0347a925 || !$ice709f1220fec1ada7d520fc8388dda967c39d87->isLoggedIn()) { $ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8->addFieldToFilter('store_group_id', $i589c2cccd18de711ec5e779b98b9f98d0347a925); } else { $ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8->getSelect()->group('admin_id'); } if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'updateOrderStatus') { $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = $i5e65dd16263683749d16a84171f719e768ed14b5->getStatus(); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = preg_replace('/[^a-zA-Z0-9_]/', '_', $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = preg_replace('/^([^a-zA-Z])/', 'x$1', $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5); $i5aea14ef53aca1d424d64d1e1000254f9eefa3e4 = new \Magento\Framework\Stdlib\StringUtils(); $ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8->addFieldToFilter('name', 'orderStatus'.$i5aea14ef53aca1d424d64d1e1000254f9eefa3e4->upperCaseWords($ia0b4e748647d3e52f7c9741d5f659711a2db6dc5, '_', '')); $i7744e4decfaad72e8b713dad6e312bdd2770c4da = $i41496536c6b29c24b90c374d9fc25143f114dc9a.' - orderStatus'.$i5aea14ef53aca1d424d64d1e1000254f9eefa3e4->upperCaseWords($ia0b4e748647d3e52f7c9741d5f659711a2db6dc5, '_', ''); } else { $ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8->addFieldToFilter('name', $i41496536c6b29c24b90c374d9fc25143f114dc9a); $i7744e4decfaad72e8b713dad6e312bdd2770c4da = $i41496536c6b29c24b90c374d9fc25143f114dc9a; } if ($ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8->count()) { $if2014d170e15e7f6f64523fd3238720980ceb64a = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\ResourceModel\Hooks\Unicode\Collection::class); $ie8d90f6313614fbb6564426c0b0cb59a0ca4cecd = $if2014d170e15e7f6f64523fd3238720980ceb64a->addFieldToFilter('type', 'admin')->getFirstItem(); foreach($ib8622dd6b5bb413f7d6f85eb31e2abce529ae0a8 as $i3d68c0cf53594c3449a7debf01d1c337a93fc4ae) { $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->create(\Topefekt\Magesms\Model\Admins::class); $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87 = $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->load($i3d68c0cf53594c3449a7debf01d1c337a93fc4ae->getAdminId()); if (!$i2977ace3ff82db806c1e7c92dd6811f3d76f0e87) continue; $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->create(\Topefekt\Magesms\Model\Sms::class); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->addRecipient($i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->getNumber(), ['recipient' => $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->getName(), 'adminId' => $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->getId()]) ->setMessage($this->_helper->prepareText($i3d68c0cf53594c3449a7debf01d1c337a93fc4ae->getSmstext(), $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66, null, null, $i41496536c6b29c24b90c374d9fc25143f114dc9a, $i5e65dd16263683749d16a84171f719e768ed14b5)) ->setSubject($i7744e4decfaad72e8b713dad6e312bdd2770c4da) ->setType(\Topefekt\Magesms\Model\Sms::TYPE_ADMIN) ->setPriority(true) ->setUnicode($ie8d90f6313614fbb6564426c0b0cb59a0ca4cecd->getUnicode()) ->setStoreId($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->setHookName($i7744e4decfaad72e8b713dad6e312bdd2770c4da); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->setNotNotification($i9ead6d05bd4aaf6513f7229d48e9996fa59d638e); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->send(); } } if ($i5e65dd16263683749d16a84171f719e768ed14b5 instanceof \Magento\Sales\Api\Data\OrderInterface && $this->_helper->getConfig('magesms/magesms/customer_groups_enable', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)) { $groups = $this->_helper->getConfig('magesms/magesms/customer_groups', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); if (!in_array($i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerGroupId(), explode(',', $groups))) return $this; } $i71e09ed37bc7273d250df9932c1693668e879cdd = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\ResourceModel\Hooks\Customers\Collection::class); $i71e09ed37bc7273d250df9932c1693668e879cdd->addFieldToFilter('active', 1) ->addFieldToFilter('mutation', $this->_helper->getConfig('general/locale/code', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)); if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'updateOrderStatus') { $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = $i5e65dd16263683749d16a84171f719e768ed14b5->getStatus(); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = preg_replace('/[^a-zA-Z0-9_]/', '_', $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5); $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5 = preg_replace('/^([^a-zA-Z])/', 'x$1', $ia0b4e748647d3e52f7c9741d5f659711a2db6dc5); $i5aea14ef53aca1d424d64d1e1000254f9eefa3e4 = new \Magento\Framework\Stdlib\StringUtils(); $i71e09ed37bc7273d250df9932c1693668e879cdd->addFieldToFilter('name', 'orderStatus'.$i5aea14ef53aca1d424d64d1e1000254f9eefa3e4->upperCaseWords($ia0b4e748647d3e52f7c9741d5f659711a2db6dc5, '_', '')); $i7744e4decfaad72e8b713dad6e312bdd2770c4da = $i41496536c6b29c24b90c374d9fc25143f114dc9a.' - orderStatus'.$i5aea14ef53aca1d424d64d1e1000254f9eefa3e4->upperCaseWords($ia0b4e748647d3e52f7c9741d5f659711a2db6dc5, '_', ''); } else { $i71e09ed37bc7273d250df9932c1693668e879cdd->addFieldToFilter('name', $i41496536c6b29c24b90c374d9fc25143f114dc9a); $i7744e4decfaad72e8b713dad6e312bdd2770c4da = $i41496536c6b29c24b90c374d9fc25143f114dc9a; } if ($i71e09ed37bc7273d250df9932c1693668e879cdd->count()) { if ($i5e65dd16263683749d16a84171f719e768ed14b5 instanceof \Magento\Sales\Api\Data\OrderInterface) { $ib8129b89cda7dae2cfe1b114353de8ba2385974e = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->create(\Topefekt\Magesms\Model\ResourceModel\Optout\Order\Collection::class); $ib8129b89cda7dae2cfe1b114353de8ba2385974e->addFieldToFilter('order_id', $i5e65dd16263683749d16a84171f719e768ed14b5->getId()) ->addFieldToFilter('disabled', 1); if ($ib8129b89cda7dae2cfe1b114353de8ba2385974e->count()) { return $this; } if ($i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18->user->getPrefbilling()) { if ($i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress()) { $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = $i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress()->getTelephone(); $idcde4f5fb5532c8e634fa3aa4c7ce182a046d76b = $i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress()->getCountryId(); } if (empty($i1f1945594819c4321de45ac15ed6d4dc07f41e2f) || !preg_match('/^[0-9+()\/\.\s-]+$/', $i1f1945594819c4321de45ac15ed6d4dc07f41e2f)) { $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = $i5e65dd16263683749d16a84171f719e768ed14b5->getBillingAddress()->getTelephone(); $idcde4f5fb5532c8e634fa3aa4c7ce182a046d76b = $i5e65dd16263683749d16a84171f719e768ed14b5->getBillingAddress()->getCountryId(); } } else { $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = $i5e65dd16263683749d16a84171f719e768ed14b5->getBillingAddress()->getTelephone(); $idcde4f5fb5532c8e634fa3aa4c7ce182a046d76b = $i5e65dd16263683749d16a84171f719e768ed14b5->getBillingAddress()->getCountryId(); if (empty($i1f1945594819c4321de45ac15ed6d4dc07f41e2f) || !preg_match('/^[0-9+()\/\.\s-]+$/', $i1f1945594819c4321de45ac15ed6d4dc07f41e2f)) { $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = $i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress()->getTelephone(); $idcde4f5fb5532c8e634fa3aa4c7ce182a046d76b = $i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress()->getCountryId(); } } if (!preg_match('/^[0-9+()\/\.\s-]+$/', $i1f1945594819c4321de45ac15ed6d4dc07f41e2f)) $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = ''; $ifb2b31a17a2f13d19aebc5823ae02f42988a78f2 = $i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerId(); if (!$ifb2b31a17a2f13d19aebc5823ae02f42988a78f2) $ifb2b31a17a2f13d19aebc5823ae02f42988a78f2 = 0; $i489c048e0604d314330360b5ee23b42f486ebb98 = $i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerName(); } else { $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = ''; $ifb2b31a17a2f13d19aebc5823ae02f42988a78f2 = $i5e65dd16263683749d16a84171f719e768ed14b5->getId(); } if (!$i1f1945594819c4321de45ac15ed6d4dc07f41e2f) { $ia8a35a47a8e61218e15d1a33dac64bdc2449c01a = $this->_request->getParams(); foreach(['mobilenumber', 'mobile_number', 'phone', 'phone_number', 'telephone', 'mobile', 'mobilephone'] as $i670253c23c6fcba76bc4256a88fdd8fbc1041039) { if (!empty($ia8a35a47a8e61218e15d1a33dac64bdc2449c01a[$i670253c23c6fcba76bc4256a88fdd8fbc1041039])) { $i1f1945594819c4321de45ac15ed6d4dc07f41e2f = $ia8a35a47a8e61218e15d1a33dac64bdc2449c01a[$i670253c23c6fcba76bc4256a88fdd8fbc1041039]; $idcde4f5fb5532c8e634fa3aa4c7ce182a046d76b = $this->_helper->getConfig('general/country/default', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); break; } } } if ($i1f1945594819c4321de45ac15ed6d4dc07f41e2f && is_numeric($ifb2b31a17a2f13d19aebc5823ae02f42988a78f2)) { $ifede0aa7d9c3f77f8ca4eb9c1002d82f3a770ae7 = $i71e09ed37bc7273d250df9932c1693668e879cdd->getFirstItem(); $i6d6da9eb4bc3bca1db3f4eb2b907f496d625d20f = $ifede0aa7d9c3f77f8ca4eb9c1002d82f3a770ae7->getSmstext(); if ($i6d6da9eb4bc3bca1db3f4eb2b907f496d625d20f) { $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->create(\Topefekt\Magesms\Model\Sms::class); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->addRecipient($i1f1945594819c4321de45ac15ed6d4dc07f41e2f, ['recipient' => $i489c048e0604d314330360b5ee23b42f486ebb98, 'customerId' => $ifb2b31a17a2f13d19aebc5823ae02f42988a78f2, 'country' => $idcde4f5fb5532c8e634fa3aa4c7ce182a046d76b]) ->setMessage($this->_helper->prepareText($i6d6da9eb4bc3bca1db3f4eb2b907f496d625d20f, $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66, null, null, $i41496536c6b29c24b90c374d9fc25143f114dc9a, $i5e65dd16263683749d16a84171f719e768ed14b5)) ->setSubject($i7744e4decfaad72e8b713dad6e312bdd2770c4da) ->setType(\Topefekt\Magesms\Model\Sms::TYPE_CUSTOMER) ->setPriority(true) ->setStoreId($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); $if2014d170e15e7f6f64523fd3238720980ceb64a = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\ResourceModel\Hooks\Unicode\Collection::class); $if2014d170e15e7f6f64523fd3238720980ceb64a->addFieldToFilter('type', 'customer') ->addFieldToFilter('area', $ifede0aa7d9c3f77f8ca4eb9c1002d82f3a770ae7->getMutation()); if ($if2014d170e15e7f6f64523fd3238720980ceb64a->count()) { $ie8d90f6313614fbb6564426c0b0cb59a0ca4cecd = $if2014d170e15e7f6f64523fd3238720980ceb64a->getFirstItem(); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->setUnicode($ie8d90f6313614fbb6564426c0b0cb59a0ca4cecd->getUnicode()); } $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->setHookName($i7744e4decfaad72e8b713dad6e312bdd2770c4da); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->setNotNotification($i9ead6d05bd4aaf6513f7229d48e9996fa59d638e); $i2012325f8714e1168a6c4fd06b9fa8eee23fcc7f->send(); } } } } } } 