<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
 namespace Topefekt\Magesms\Helper; use Magento\Framework\App\Config\ScopeConfigInterface; use Magento\Framework\App\Helper\Context; use Magento\Framework\App\ProductMetadataInterface; use Magento\Framework\DataObject; use Magento\Framework\Locale\Resolver; use Magento\Framework\Locale\TranslatedLists; use Magento\Framework\Module\ModuleList; use Magento\Framework\Registry; use Topefekt\Magesms\Model\Country\Lang; use Magento\Store\Model\StoreManagerInterface; use Topefekt\Magesms\Model\Smsprofile; class Data extends \Magento\Framework\App\Helper\AbstractHelper { const MAGESMS_ENABLE = 'magesms/magesms/enable'; private $v148194b5b9cc653ce2e35e9709e441dc6fd4123a; protected $_moduleList; protected $_productMetadata; protected $_resolver; protected $_lang; protected $_registry; protected $_storeManager; protected $_translatedLists; protected $_currency; public function __construct(Context $i31cc913adc2717e2346d503153c97449098831aa, ModuleList $if2de722217dd95ae90fee82aa42ecbfff56f2b99, ProductMetadataInterface $i3a2258c586fccda570d69ddf02a22888cb589055, Resolver $ia1c59fd11fa86894dafd280895a5bbceec6a96de, TranslatedLists $id70080e65d46d084de8d91ddb6bd9653b1de3810, Lang $i593f9fb6306ab4cdb862f1ef6769504d63647c90, Registry $ie9fe5cdc9fc7093987f4d41ad4cae3554e64e17b, \Magento\Directory\Model\Currency $i2f27bb6238dceccb377204f79e5c8e611dfa4b5e, StoreManagerInterface $i06a381e12f304723bef83828539567b279a48b64) { $this->_moduleList = $if2de722217dd95ae90fee82aa42ecbfff56f2b99; $this->_productMetadata = $i3a2258c586fccda570d69ddf02a22888cb589055; $this->_resolver = $ia1c59fd11fa86894dafd280895a5bbceec6a96de; $this->_lang = $i593f9fb6306ab4cdb862f1ef6769504d63647c90; $this->_registry = $ie9fe5cdc9fc7093987f4d41ad4cae3554e64e17b; $this->_storeManager = $i06a381e12f304723bef83828539567b279a48b64; parent::__construct($i31cc913adc2717e2346d503153c97449098831aa); $this->_translatedLists = $id70080e65d46d084de8d91ddb6bd9653b1de3810; $this->_currency = $i2f27bb6238dceccb377204f79e5c8e611dfa4b5e; } public function getConfig($i9bb61d23b78b6b8546ec9e2d24f6910d0a69d038, $iafdc4f94bf65e0c500b65742405b500b099f793f = null, $i3adb3ddb086d4ea32e4b9a926675579d30fad98b = ScopeConfigInterface::SCOPE_TYPE_DEFAULT) { return $this->scopeConfig->getValue( $i9bb61d23b78b6b8546ec9e2d24f6910d0a69d038, $i3adb3ddb086d4ea32e4b9a926675579d30fad98b, $iafdc4f94bf65e0c500b65742405b500b099f793f ); } public function isActive($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66 = null) { return $this->getConfig(self::MAGESMS_ENABLE, $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); } public function getModuleVersion() { $icc6cb4ab317434cdcd0a97a846e4ac3247a8b41a = $this->_moduleList->getOne('Topefekt_Magesms'); return $icc6cb4ab317434cdcd0a97a846e4ac3247a8b41a['setup_version']; } public function getMagentoVersion() { return $this->_productMetadata->getVersion(); } public function detectLang($iccb00baf62ef7b52dab4785b2fe3e5d6471b5d03 = false) { if (!empty($_SERVER['HTTP_ACCEPT_LANGUAGE'])) { $ie54fcd5470bd7f31f709089290e33bb03e655c25 = explode(',', $_SERVER['HTTP_ACCEPT_LANGUAGE']); foreach ($ie54fcd5470bd7f31f709089290e33bb03e655c25 as &$i593f9fb6306ab4cdb862f1ef6769504d63647c90) { $ib473854f4b306e706e896b68ceb14665e7bc5475 = explode(';', $i593f9fb6306ab4cdb862f1ef6769504d63647c90); if (!empty($ib473854f4b306e706e896b68ceb14665e7bc5475[0])) $i593f9fb6306ab4cdb862f1ef6769504d63647c90 = $ib473854f4b306e706e896b68ceb14665e7bc5475[0]; } } else { $i4e4643965424fd5279d5992f6c669c0a56d9a1a3 = $this->_resolver->getDefaultLocale(); $ie54fcd5470bd7f31f709089290e33bb03e655c25 = explode('_', $i4e4643965424fd5279d5992f6c669c0a56d9a1a3); } foreach ($ie54fcd5470bd7f31f709089290e33bb03e655c25 as $ib473854f4b306e706e896b68ceb14665e7bc5475) { $iff7e46827cbb6547116c592bf800f4687428abf9 = $this->_lang->getCollection(); $iff7e46827cbb6547116c592bf800f4687428abf9->addFieldToFilter('lang', strtolower($ib473854f4b306e706e896b68ceb14665e7bc5475)); foreach ($iff7e46827cbb6547116c592bf800f4687428abf9 as $i4cf0596ef3a67e5add95b49723a3c49aecd1dbd3) { return $iccb00baf62ef7b52dab4785b2fe3e5d6471b5d03 ? $i4cf0596ef3a67e5add95b49723a3c49aecd1dbd3->getIso2() : $i4cf0596ef3a67e5add95b49723a3c49aecd1dbd3->getCountryName(); } } $this->_logger->info('Dont detect lang: '.$_SERVER['HTTP_ACCEPT_LANGUAGE']); return 'en'; } public function getMutations() { $ie54fcd5470bd7f31f709089290e33bb03e655c25 = []; $ice21cd4390308309015957a221ff2bff67f397ce = $this->_translatedLists->getOptionLocales(); foreach ($this->_storeManager->getStores() as $i3763a59a4c1873eeb396b46caa87140ccb7bc631) { $ia35eb6e21739b9f362d4085ebe7dee274bc421a7 = $this->getConfig('general/locale/code', $i3763a59a4c1873eeb396b46caa87140ccb7bc631->getId(), 'store'); if (isset($ie54fcd5470bd7f31f709089290e33bb03e655c25[$ia35eb6e21739b9f362d4085ebe7dee274bc421a7])) { $ie54fcd5470bd7f31f709089290e33bb03e655c25[$ia35eb6e21739b9f362d4085ebe7dee274bc421a7]['stores'] = array_merge($ie54fcd5470bd7f31f709089290e33bb03e655c25[$ia35eb6e21739b9f362d4085ebe7dee274bc421a7]['stores'], [ $this->getConfig('general/store_information/name', $i3763a59a4c1873eeb396b46caa87140ccb7bc631->getStoreId()). ' ('.$i3763a59a4c1873eeb396b46caa87140ccb7bc631->getName().')' ]); continue; } foreach ($ice21cd4390308309015957a221ff2bff67f397ce as $i4e4643965424fd5279d5992f6c669c0a56d9a1a3) { if ($i4e4643965424fd5279d5992f6c669c0a56d9a1a3['value'] == $ia35eb6e21739b9f362d4085ebe7dee274bc421a7) { $ie54fcd5470bd7f31f709089290e33bb03e655c25[$ia35eb6e21739b9f362d4085ebe7dee274bc421a7] = $i4e4643965424fd5279d5992f6c669c0a56d9a1a3; $ie54fcd5470bd7f31f709089290e33bb03e655c25[$ia35eb6e21739b9f362d4085ebe7dee274bc421a7]['stores'] = [ $this->getConfig('general/store_information/name', $i3763a59a4c1873eeb396b46caa87140ccb7bc631->getStoreId(), 'store'). ' ('.$i3763a59a4c1873eeb396b46caa87140ccb7bc631->getName().')' ]; $ie54fcd5470bd7f31f709089290e33bb03e655c25[$ia35eb6e21739b9f362d4085ebe7dee274bc421a7]['selected'] = 0; break; } } } return $ie54fcd5470bd7f31f709089290e33bb03e655c25; } public function formatPrice($i58457975a91d59a84d2920953badcb7365ac1f01, $i2457499363c0873527a65aa9ad19ce774bd79cbc = 4) { return number_format((float)$i58457975a91d59a84d2920953badcb7365ac1f01, $i2457499363c0873527a65aa9ad19ce774bd79cbc, ",", " "); } public function hookVariablesJS($idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa) { if (preg_match_all('/{(.*?)}/', $idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa, $ia00c63b7b8f0d76f361b9bd281e5073cc0d0aa3e)) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b = array(); foreach ($ia00c63b7b8f0d76f361b9bd281e5073cc0d0aa3e[1] as $iebd691e534c6cf2e84cf8a88790a5271154fca05) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b[$iebd691e534c6cf2e84cf8a88790a5271154fca05] = '{'.$iebd691e534c6cf2e84cf8a88790a5271154fca05.'}'; } $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e = \Magento\Framework\App\ObjectManager::getInstance(); $i322d20c6b1eb01ecb5d5801e003969fcc1f407a9 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\Variables::class)->getCollection() ->addFieldToFilter('name', ['in' => [array_keys($i0933475b5bd80561a9f50282fd9eb0b8345cec4b)]]); foreach ($i322d20c6b1eb01ecb5d5801e003969fcc1f407a9 as $iebd691e534c6cf2e84cf8a88790a5271154fca05) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b[$iebd691e534c6cf2e84cf8a88790a5271154fca05->getName()] = $iebd691e534c6cf2e84cf8a88790a5271154fca05->getTemplate() ? __($iebd691e534c6cf2e84cf8a88790a5271154fca05->getTemplate()) : $iebd691e534c6cf2e84cf8a88790a5271154fca05->getTemplate(); } $i5528ed14b056e3debe4695094269de3a98f76fe7 = ''; foreach ($i0933475b5bd80561a9f50282fd9eb0b8345cec4b as $i670253c23c6fcba76bc4256a88fdd8fbc1041039 => $if2eee0665f163a28f4adcfe84e3fc666bf1bcd89) { if (!empty($i5528ed14b056e3debe4695094269de3a98f76fe7)) $i5528ed14b056e3debe4695094269de3a98f76fe7 .= ', '; $i5528ed14b056e3debe4695094269de3a98f76fe7 .= $i670253c23c6fcba76bc4256a88fdd8fbc1041039.': "'.$if2eee0665f163a28f4adcfe84e3fc666bf1bcd89.'"'; } return $i5528ed14b056e3debe4695094269de3a98f76fe7; } } public function prepareText(String $idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa, $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66 = null, $i7a5ea366969a291381fafa1448c9a2fafd34ad5e = null, $i9ec689e1c80cd31f364efa77b20f79dcf2612cf0 = null, $i41496536c6b29c24b90c374d9fc25143f114dc9a = null, $i5e65dd16263683749d16a84171f719e768ed14b5 = null) { $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e = \Magento\Framework\App\ObjectManager::getInstance(); if ($this->_registry->registry('magesms_store_id')) $this->_registry->unregister('magesms_store_id'); $this->_registry->register('magesms_store_id', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66, true); if (preg_match_all('/{(.*?)}/', $idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa, $ia00c63b7b8f0d76f361b9bd281e5073cc0d0aa3e)) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b = []; foreach ($ia00c63b7b8f0d76f361b9bd281e5073cc0d0aa3e[1] as $iebd691e534c6cf2e84cf8a88790a5271154fca05) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b[$iebd691e534c6cf2e84cf8a88790a5271154fca05] = '{'.$iebd691e534c6cf2e84cf8a88790a5271154fca05.'}'; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_domain'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_domain'] = $this->getConfig('web/unsecure/base_url', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name'] = $this->getConfig('general/store_information/name', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); if (empty($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name'])) { if (!empty($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name'] = $this->_storeManager->getStore($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)->getName(); } else { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name'] = $this->_storeManager->getStore()->getName(); } } } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name2'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_name2'] = $this->_storeManager->getStore($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)->getName(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_email'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_email'] = $this->getConfig('trans_email/ident_general/email', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_phone'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['shop_phone'] = $this->getConfig('general/store_information/phone', $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66); } if (is_object($i7a5ea366969a291381fafa1448c9a2fafd34ad5e) && $i7a5ea366969a291381fafa1448c9a2fafd34ad5e instanceof DataObject) { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_firstname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_firstname'] = $i7a5ea366969a291381fafa1448c9a2fafd34ad5e->getFirstname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_lastname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_lastname'] = $i7a5ea366969a291381fafa1448c9a2fafd34ad5e->getLastname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'] = $i7a5ea366969a291381fafa1448c9a2fafd34ad5e->getEmail(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_phone'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_phone'] = $i7a5ea366969a291381fafa1448c9a2fafd34ad5e->getTelephone(); } } if (!empty($i9ec689e1c80cd31f364efa77b20f79dcf2612cf0) && is_object($i9ec689e1c80cd31f364efa77b20f79dcf2612cf0)) { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_name'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_name'] = $i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getName(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_code'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_code'] = $i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getCoupon()->getCode(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_description'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_description'] = $i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getDescription(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_reduction_percent'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_reduction_percent'] = $this->_currency->format($i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getDiscountAmount(), ['display'=>\Zend_Currency::NO_SYMBOL], false); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_reduction_amount'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_reduction_amount'] = $this->_currency->format($i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getDiscountAmount(), ['display'=>\Zend_Currency::NO_SYMBOL], false); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_reduction_currency'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_reduction_currency'] = $this->_storeManager->getStore($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)->getCurrentCurrencyCode(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_date_start'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_date_start'] = $i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getFromDate(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_date_end'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_date_end'] = $i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getToDate(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_quantity'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['coupon_quantity'] = (int)$i9ec689e1c80cd31f364efa77b20f79dcf2612cf0->getDiscountQty(); } } if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'contactForm') { $iacbd1c78463510856e506611fe14b5e1173581a6 = $this->_request; if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'] = trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('email')); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_name'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_name'] = trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('name')); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_phone'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_phone'] = trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('telephone')); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message'] = trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('comment')); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message_short1'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message_short1'] = mb_substr(trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('comment')), 0, 120); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message_short2'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message_short2'] = mb_substr(trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('comment')), 0, 100); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message_short3'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_message_short3'] = mb_substr(trim($iacbd1c78463510856e506611fe14b5e1173581a6->getPost('comment')), 0, 80); } } if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'customerRegisterSuccess') { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_id'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_id'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getId(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getEmail(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_password'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_password'] = $this->_request->getParam('password'); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_firstname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_firstname'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getFirstname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_lastname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_lastname'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getLastname(); } } if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'newOrder' || $i41496536c6b29c24b90c374d9fc25143f114dc9a == 'updateOrderStatus' || $i41496536c6b29c24b90c374d9fc25143f114dc9a == 'updateOrderTrackingNumber') { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_id'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_id'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerId(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_email'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerEmail(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_firstname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_firstname'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerFirstname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_lastname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_lastname'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getCustomerLastname(); } if (empty($i22b151d2a920ca46892d343096abbccfad9f3678)) $i22b151d2a920ca46892d343096abbccfad9f3678 = $i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress(); if (empty($i22b151d2a920ca46892d343096abbccfad9f3678)) $i22b151d2a920ca46892d343096abbccfad9f3678 = $i5e65dd16263683749d16a84171f719e768ed14b5->getBillingAddress(); if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_shipping_firstname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_shipping_firstname'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getFirstname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_shipping_lastname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_shipping_lastname'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getLastname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_company'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_company'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getCompany(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_address'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_address'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getStreet(1); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_postcode'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_postcode'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getPostcode(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_city'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_city'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getCity(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_country'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_country'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getCountry(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_state'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_state'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getRegion(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_phone'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_phone'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getTelephone(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_vat_number'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_vat_number'] = $i22b151d2a920ca46892d343096abbccfad9f3678->getVatId(); } if (empty($i560c12365c45b205daa0512840c70486783226b1)) $i560c12365c45b205daa0512840c70486783226b1 = $i5e65dd16263683749d16a84171f719e768ed14b5->getBillingAddress(); if (empty($i560c12365c45b205daa0512840c70486783226b1)) $i560c12365c45b205daa0512840c70486783226b1 = $i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAddress(); if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_company'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_company'] = $i560c12365c45b205daa0512840c70486783226b1->getCompany(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_firstname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_firstname'] = $i560c12365c45b205daa0512840c70486783226b1->getFirstname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_lastname'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_lastname'] = $i560c12365c45b205daa0512840c70486783226b1->getLastname(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_address'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_address'] = $i560c12365c45b205daa0512840c70486783226b1->getStreet(1); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_postcode'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_postcode'] = $i560c12365c45b205daa0512840c70486783226b1->getPostcode(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_city'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_city'] = $i560c12365c45b205daa0512840c70486783226b1->getCity(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_country'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_country'] = $i560c12365c45b205daa0512840c70486783226b1->getCountry(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_state'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_state'] = $i560c12365c45b205daa0512840c70486783226b1->getRegion(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_phone'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_phone'] = $i560c12365c45b205daa0512840c70486783226b1->getTelephone(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_vat_number'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['customer_invoice_vat_number'] = $i560c12365c45b205daa0512840c70486783226b1->getVatId(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_id'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_id'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getIncrementId(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_payment'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_payment'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getPayment()->getMethodInstance()->getTitle(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_total_paid'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_total_paid'] = $this->_currency->format($i5e65dd16263683749d16a84171f719e768ed14b5->getGrandTotal(), ['display'=>\Zend_Currency::NO_SYMBOL], false); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_subtotal'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_subtotal'] = $this->_currency->format($i5e65dd16263683749d16a84171f719e768ed14b5->getSubtotal(), ['display'=>\Zend_Currency::NO_SYMBOL], false); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_shipping_amount'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_shipping_amount'] = $this->_currency->format($i5e65dd16263683749d16a84171f719e768ed14b5->getShippingAmount(), ['display'=>\Zend_Currency::NO_SYMBOL], false); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_currency'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_currency'] = $i5e65dd16263683749d16a84171f719e768ed14b5->getOrderCurrency()->getCurrencyCode(); } $this->f2b4066ec99f97011a4a9f20dd18d97b5a49b8b51($i0933475b5bd80561a9f50282fd9eb0b8345cec4b, $i5e65dd16263683749d16a84171f719e768ed14b5->getCreatedAt()); if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'newOrder') { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['cart_id'])) { $i0e3e80cee9c51f140b823db0b7df66493acca657 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Magento\Checkout\Model\Session::class); $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['cart_id'] = $i0e3e80cee9c51f140b823db0b7df66493acca657->getQuoteId(); } $i32ce098f2dde8081cf3c4de31f52b408a6ad48be = $i5e65dd16263683749d16a84171f719e768ed14b5->getAllItems(); if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder1'])) { $i813c950729f632ca03f8c203c0a769de5e8bdf29 = []; foreach($i32ce098f2dde8081cf3c4de31f52b408a6ad48be as $i69a1201e93806d55c970dfb18feec53d221ba37b) { $i813c950729f632ca03f8c203c0a769de5e8bdf29[] = $i69a1201e93806d55c970dfb18feec53d221ba37b->getProductId().'/'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getName().'/'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getQtyOrdered(); } $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder1'] = implode('; ', $i813c950729f632ca03f8c203c0a769de5e8bdf29); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder2'])) { $i813c950729f632ca03f8c203c0a769de5e8bdf29 = []; foreach($i32ce098f2dde8081cf3c4de31f52b408a6ad48be as $i69a1201e93806d55c970dfb18feec53d221ba37b) { $i813c950729f632ca03f8c203c0a769de5e8bdf29[] = 'id:'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getProductId().', ' .__('name').':'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getName().', ' .__('qty').':'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getQtyOrdered(); } $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder2'] = implode('; ', $i813c950729f632ca03f8c203c0a769de5e8bdf29); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder3'])) { $i813c950729f632ca03f8c203c0a769de5e8bdf29 = []; foreach($i32ce098f2dde8081cf3c4de31f52b408a6ad48be as $i69a1201e93806d55c970dfb18feec53d221ba37b) { $i813c950729f632ca03f8c203c0a769de5e8bdf29[] = $i69a1201e93806d55c970dfb18feec53d221ba37b->getProductId().'/'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getQtyOrdered(); } $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder3'] = implode('; ', $i813c950729f632ca03f8c203c0a769de5e8bdf29); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder4'])) { $i813c950729f632ca03f8c203c0a769de5e8bdf29 = []; foreach($i32ce098f2dde8081cf3c4de31f52b408a6ad48be as $i69a1201e93806d55c970dfb18feec53d221ba37b) { $i813c950729f632ca03f8c203c0a769de5e8bdf29[] = 'id:'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getProductId().', ' .__('qty').':'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getQtyOrdered(); } $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder4'] = implode('; ', $i813c950729f632ca03f8c203c0a769de5e8bdf29); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder5'])) { $i813c950729f632ca03f8c203c0a769de5e8bdf29 = []; foreach($i32ce098f2dde8081cf3c4de31f52b408a6ad48be as $i69a1201e93806d55c970dfb18feec53d221ba37b) { $i813c950729f632ca03f8c203c0a769de5e8bdf29[] = $i69a1201e93806d55c970dfb18feec53d221ba37b->getProductId().'/'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getSku().'/'.$i69a1201e93806d55c970dfb18feec53d221ba37b->getQtyOrdered(); } $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['newOrder5'] = implode('; ', $i813c950729f632ca03f8c203c0a769de5e8bdf29); } } if ($i41496536c6b29c24b90c374d9fc25143f114dc9a == 'updateOrderStatus' || $i41496536c6b29c24b90c374d9fc25143f114dc9a == 'updateOrderTrackingNumber') { if (!($i9805d668f75b6b461f88474f57c5f6aa86a87316 = $this->_registry->registry('magesms_track_obj'))) $i9805d668f75b6b461f88474f57c5f6aa86a87316 = $i5e65dd16263683749d16a84171f719e768ed14b5->getTracksCollection()->getLastItem(); if (!$i9805d668f75b6b461f88474f57c5f6aa86a87316->getId()) { $ia8a35a47a8e61218e15d1a33dac64bdc2449c01a = $this->_request->getParams(); if (isset($ia8a35a47a8e61218e15d1a33dac64bdc2449c01a['tracking']) && ($i71035ea6aa66350bb658a262013eb58377a0934e = $ia8a35a47a8e61218e15d1a33dac64bdc2449c01a['tracking'])) { $i71035ea6aa66350bb658a262013eb58377a0934e = end($i71035ea6aa66350bb658a262013eb58377a0934e); if (!empty($i71035ea6aa66350bb658a262013eb58377a0934e['title'])) $i9805d668f75b6b461f88474f57c5f6aa86a87316->setTitle($i71035ea6aa66350bb658a262013eb58377a0934e['title']); if (!empty($i71035ea6aa66350bb658a262013eb58377a0934e['number'])) $i9805d668f75b6b461f88474f57c5f6aa86a87316->setTrackNumber($i71035ea6aa66350bb658a262013eb58377a0934e['number']); } } if ($i9805d668f75b6b461f88474f57c5f6aa86a87316) { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['carrier_name'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['carrier_name'] = $i9805d668f75b6b461f88474f57c5f6aa86a87316->getTitle(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_shipping_number'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_shipping_number'] = $i9805d668f75b6b461f88474f57c5f6aa86a87316->getTrackNumber(); } } $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Magento\Backend\Model\Session::class); $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87 = $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->getUser(); if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['employee_id'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['employee_id'] = $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->getId(); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['employee_email'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['employee_email'] = $i2977ace3ff82db806c1e7c92dd6811f3d76f0e87->getEmail(); } } } foreach ($i0933475b5bd80561a9f50282fd9eb0b8345cec4b as $i670253c23c6fcba76bc4256a88fdd8fbc1041039 => $if2eee0665f163a28f4adcfe84e3fc666bf1bcd89) { $idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa = str_replace('{'.$i670253c23c6fcba76bc4256a88fdd8fbc1041039.'}', $if2eee0665f163a28f4adcfe84e3fc666bf1bcd89, $idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa); } } return $idfc9fbe8edf868c14fc4a3f15c7f40aabfa080aa; } private function f2b4066ec99f97011a4a9f20dd18d97b5a49b8b51(&$i0933475b5bd80561a9f50282fd9eb0b8345cec4b, $i53ddb2282ac3aca0d44abe35abcf69959ed66574) { if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date'] = $i53ddb2282ac3aca0d44abe35abcf69959ed66574; } $i17c20960d197486b19dc890665362a4f2fd6f24a = date_parse($i53ddb2282ac3aca0d44abe35abcf69959ed66574); if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date1'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date1'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['day'].'.'.$i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'.'.$i17c20960d197486b19dc890665362a4f2fd6f24a['year']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date2'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date2'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['day'].'/'.$i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'/'.$i17c20960d197486b19dc890665362a4f2fd6f24a['year']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date3'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date3'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['day'].'-'.$i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'-'.$i17c20960d197486b19dc890665362a4f2fd6f24a['year']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date4'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date4'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['year'].'-'.$i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'-'.$i17c20960d197486b19dc890665362a4f2fd6f24a['day']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date5'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date5'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'.'.$i17c20960d197486b19dc890665362a4f2fd6f24a['day'].'.'.$i17c20960d197486b19dc890665362a4f2fd6f24a['year']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date6'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date6'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'/'.$i17c20960d197486b19dc890665362a4f2fd6f24a['day'].'/'.$i17c20960d197486b19dc890665362a4f2fd6f24a['year']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date7'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_date7'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['month'].'-'.$i17c20960d197486b19dc890665362a4f2fd6f24a['day'].'-'.$i17c20960d197486b19dc890665362a4f2fd6f24a['year']; } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_time'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_time'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['hour'].':'.sprintf('%02.0f', $i17c20960d197486b19dc890665362a4f2fd6f24a['minute']); } if (isset($i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_time1'])) { $i0933475b5bd80561a9f50282fd9eb0b8345cec4b['order_time1'] = $i17c20960d197486b19dc890665362a4f2fd6f24a['hour'].':'.sprintf('%02.0f', $i17c20960d197486b19dc890665362a4f2fd6f24a['minute']).':'.sprintf('%02.0f', $i17c20960d197486b19dc890665362a4f2fd6f24a['second']); } } public function prepareNumber($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, $i30f20aafde612a957f7f966cb5b85e35782bc88a, $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd, $i3bf172bc34c83f4a18624b192bc0bd7c4d647a66 = null) { $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e = \Magento\Framework\App\ObjectManager::getInstance(); $ibad5149cd536c7e1f814c7b3874463985a5fc9e0 = $ib40be13647f8bcb177e647eb770e6ac08b117290 = 0; $i7492a7ab99a6ff1e0ae253366480ecb40a550224 = ''; $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = str_replace(array(' ', '-', '(', ')', '/'), '', $iaab7d0929a7000dca6467ef8cddbf22298ab81f2); if (strpos($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, '+') === 0) $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = substr($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, 1); if (strpos($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, '00') === 0) $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = substr($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, 2); elseif (strpos($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, '0') === 0) $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = substr($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, 1); $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\Exceptions::class)->number($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd); $ib8c2593511e733deb36fb6bc932a747fcf3b754c = strlen($iaab7d0929a7000dca6467ef8cddbf22298ab81f2); if (isset($this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['maps'])) $id567d29153b9150b8add34bc81058cd5432e46a0 = $this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['maps']; else $this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['maps'] = $id567d29153b9150b8add34bc81058cd5432e46a0 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\Maps::class)->getCollection(); if ($id567d29153b9150b8add34bc81058cd5432e46a0->count()) { if ($if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd) { $ib4e103fdfd1ed6cc442d5e4b10b704780717812b = $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd.$iaab7d0929a7000dca6467ef8cddbf22298ab81f2; $ia272895aa0a96c7311ddc14cd99cfde9b3e11fa0 = strlen($ib4e103fdfd1ed6cc442d5e4b10b704780717812b); foreach ($id567d29153b9150b8add34bc81058cd5432e46a0 as $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d) { if (preg_match("/^".$iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getArea()."/", $ib4e103fdfd1ed6cc442d5e4b10b704780717812b, $i45e0dbda03c5e1b049126d29f809da95d0e0aa03)) { $i7492a7ab99a6ff1e0ae253366480ecb40a550224 = substr($ib4e103fdfd1ed6cc442d5e4b10b704780717812b, 0, strlen($iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getArea())); $ic155ac0a2e7d522b71a8f6aae45a2917bd596596 = $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getNumber(); if (($ia272895aa0a96c7311ddc14cd99cfde9b3e11fa0 - strlen($iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getArea())) == $ic155ac0a2e7d522b71a8f6aae45a2917bd596596) { $ib40be13647f8bcb177e647eb770e6ac08b117290 = 1; $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = $ib4e103fdfd1ed6cc442d5e4b10b704780717812b; break; } } } } if (!$ib40be13647f8bcb177e647eb770e6ac08b117290) { foreach ($id567d29153b9150b8add34bc81058cd5432e46a0 as $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d) { if (preg_match("/^".$iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getArea()."/", $iaab7d0929a7000dca6467ef8cddbf22298ab81f2, $i45e0dbda03c5e1b049126d29f809da95d0e0aa03)) { $i7492a7ab99a6ff1e0ae253366480ecb40a550224 = substr($iaab7d0929a7000dca6467ef8cddbf22298ab81f2, 0, strlen($iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getArea())); $ic155ac0a2e7d522b71a8f6aae45a2917bd596596 = $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getNumber(); if (($ib8c2593511e733deb36fb6bc932a747fcf3b754c - strlen($iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getArea())) == $ic155ac0a2e7d522b71a8f6aae45a2917bd596596) { $ibad5149cd536c7e1f814c7b3874463985a5fc9e0 = 1; continue; } } } } } if (!$ibad5149cd536c7e1f814c7b3874463985a5fc9e0 && !$ib40be13647f8bcb177e647eb770e6ac08b117290) $iaab7d0929a7000dca6467ef8cddbf22298ab81f2 = $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd.$iaab7d0929a7000dca6467ef8cddbf22298ab81f2; elseif (($ibad5149cd536c7e1f814c7b3874463985a5fc9e0 || $ib40be13647f8bcb177e647eb770e6ac08b117290) && $i7492a7ab99a6ff1e0ae253366480ecb40a550224) $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd = $i7492a7ab99a6ff1e0ae253366480ecb40a550224; if (!$if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd && $i7492a7ab99a6ff1e0ae253366480ecb40a550224) $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd = $i7492a7ab99a6ff1e0ae253366480ecb40a550224; $id96ad83fb93ea5189e8edb176831948b382810df = [ 'mobile' => $iaab7d0929a7000dca6467ef8cddbf22298ab81f2, 'prefix' => $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd, 'isms' => '', 'sendertype' => '', 'senderID' => '' ]; if (isset($this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['routes_'.$i30f20aafde612a957f7f966cb5b85e35782bc88a.'_'.$if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd])) $id567d29153b9150b8add34bc81058cd5432e46a0 = $this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['routes_'.$i30f20aafde612a957f7f966cb5b85e35782bc88a.'_'.$if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd]; else $this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['routes_'.$i30f20aafde612a957f7f966cb5b85e35782bc88a.'_'.$if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd] = $id567d29153b9150b8add34bc81058cd5432e46a0 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\Routes::class)->getCollection() ->addFieldToFilter('area', $if0177bfe4bf22cfbb3da2ac06eca557829f0a4cd) ->addFieldToFilter('type', $i30f20aafde612a957f7f966cb5b85e35782bc88a); if (!is_null($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)) $i898347c1def9d4effdd15deb4483c4b4a4aa8ab7 = $this->_storeManager->getStore($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)->getStoreGroupId(); foreach ($id567d29153b9150b8add34bc81058cd5432e46a0 as $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d) { $id96ad83fb93ea5189e8edb176831948b382810df['isms'] = $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getIsms(); $id96ad83fb93ea5189e8edb176831948b382810df['sendertype'] = $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getSendertype(); $id96ad83fb93ea5189e8edb176831948b382810df['senderID'] = $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getSenderId(); if (!is_null($i3bf172bc34c83f4a18624b192bc0bd7c4d647a66)) { if (isset($this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['routes-alternative_'.$iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getId().'_'.$i898347c1def9d4effdd15deb4483c4b4a4aa8ab7])) $ida3b491904fb073f446bf820cd55a0ff69b347d1 = $this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['routes-alternative_'.$iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getId().'_'.$i898347c1def9d4effdd15deb4483c4b4a4aa8ab7]; else $this->v148194b5b9cc653ce2e35e9709e441dc6fd4123a['routes-alternative_'.$iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getId().'_'.$i898347c1def9d4effdd15deb4483c4b4a4aa8ab7] = $ida3b491904fb073f446bf820cd55a0ff69b347d1 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Topefekt\Magesms\Model\Routes\Alternative::class)->getCollection() ->addFieldToFilter('route_id', $iebe3a16a01f87f9a4ebbb9731163db3e3e64cc3d->getId()) ->addFieldToFilter('store_group_id', $i898347c1def9d4effdd15deb4483c4b4a4aa8ab7); if ($ida3b491904fb073f446bf820cd55a0ff69b347d1->count()) { $id96ad83fb93ea5189e8edb176831948b382810df['senderID'] = $ida3b491904fb073f446bf820cd55a0ff69b347d1->getFirstItem()->getTextsender(); } } } return $id96ad83fb93ea5189e8edb176831948b382810df; } public function getCustomerCollection() { $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e = \Magento\Framework\App\ObjectManager::getInstance(); $iff7e46827cbb6547116c592bf800f4687428abf9 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->create(\Magento\Customer\Model\ResourceModel\Customer\Collection::class); $iff7e46827cbb6547116c592bf800f4687428abf9->addNameToSelect() ->joinAttribute('billing_telephone', 'customer_address/telephone', 'default_billing', null, 'left') ->joinAttribute('shipping_telephone', 'customer_address/telephone', 'default_shipping', null, 'left') ->joinAttribute('billing_city', 'customer_address/city', 'default_billing', null, 'left') ->joinAttribute('billing_country_id', 'customer_address/country_id', 'default_billing', null, 'left') ->joinAttribute('shipping_country_id', 'customer_address/country_id', 'default_shipping', null, 'left'); $iba20acc78644ac0e9cd48ea35d8ad03b058f6b5a = [ [ 'attribute' => 'billing_telephone', [['notnull' => true], ['neq' => '']] ], [ 'attribute' => 'shipping_telephone', [['notnull' => true], ['neq' => '']] ] ]; $i1c61f70f1fe28d52cef73773ca9defc4186e9275 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(\Magento\Catalog\Model\ResourceModel\Eav\Attribute::class); $id57d139cfcd7590b603d5b061a6237d01bc011b2 = $i1c61f70f1fe28d52cef73773ca9defc4186e9275->loadByCode('customer', 'mobile'); if ($id57d139cfcd7590b603d5b061a6237d01bc011b2->getId()) { $iff7e46827cbb6547116c592bf800f4687428abf9->joinAttribute('customer_mobile', 'customer/mobile', 'mobile', null, 'left'); $iba20acc78644ac0e9cd48ea35d8ad03b058f6b5a[] = [ 'attribute' => 'mobile', [['notnull' => true], ['neq' => '']] ]; } $iff7e46827cbb6547116c592bf800f4687428abf9->addFieldToFilter($iba20acc78644ac0e9cd48ea35d8ad03b058f6b5a); $i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18 = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->get(Smsprofile::class); if ($i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18->user->getPrefbilling()) { if ($id57d139cfcd7590b603d5b061a6237d01bc011b2->getId()) $iff7e46827cbb6547116c592bf800f4687428abf9->getSelect() ->columns('IF(`at_shipping_telephone`.`telephone`, `at_shipping_telephone`.`telephone`, IF(`at_billing_telephone`.`telephone`, `at_billing_telephone`.`telephone`, `at_mobile`.`value`)) AS telephone'); else $iff7e46827cbb6547116c592bf800f4687428abf9->getSelect() ->columns('IF(`at_shipping_telephone`.`telephone`, `at_shipping_telephone`.`telephone`, `at_billing_telephone`.`telephone`) AS telephone'); $iff7e46827cbb6547116c592bf800f4687428abf9->getSelect() ->columns('IF(`at_billing_country_id`.`country_id`, `at_billing_country_id`.`country_id`, `at_shipping_country_id`.`country_id`) AS country_id'); } else { if ($id57d139cfcd7590b603d5b061a6237d01bc011b2->getId()) $iff7e46827cbb6547116c592bf800f4687428abf9->getSelect() ->columns('IF(`at_billing_telephone`.`telephone`, `at_billing_telephone`.`telephone`, IF(`at_shipping_telephone`.`telephone`, `at_shipping_telephone`.`telephone`, `at_mobile`.`value` )) AS telephone'); else $iff7e46827cbb6547116c592bf800f4687428abf9->getSelect() ->columns('IF(`at_billing_telephone`.`telephone`, `at_billing_telephone`.`telephone`, `at_shipping_telephone`.`telephone`) AS telephone'); $iff7e46827cbb6547116c592bf800f4687428abf9->getSelect() ->columns('IF(`at_shipping_country_id`.`country_id`, `at_shipping_country_id`.`country_id`, `at_billing_country_id`.`country_id`) AS country_id'); } return $iff7e46827cbb6547116c592bf800f4687428abf9; } public function getOptoutProduct() { $ic010a5d08128ec6abcd0a1a16cb1d8abe7bf2142 = $this->getConfig('default/optout/sku'); $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e = \Magento\Framework\App\ObjectManager::getInstance(); $i69a1201e93806d55c970dfb18feec53d221ba37b = $i91f38bff7110fc85a77a8fd1a2cbfe902aa46e9e->create(\Magento\Catalog\Model\Product::class); $i69a1201e93806d55c970dfb18feec53d221ba37b = $i69a1201e93806d55c970dfb18feec53d221ba37b->loadByAttribute('sku', $ic010a5d08128ec6abcd0a1a16cb1d8abe7bf2142); if ($i69a1201e93806d55c970dfb18feec53d221ba37b && $i69a1201e93806d55c970dfb18feec53d221ba37b->getStatus() == \Magento\Catalog\Model\Product\Attribute\Source\Status::STATUS_ENABLED) return $i69a1201e93806d55c970dfb18feec53d221ba37b; } }