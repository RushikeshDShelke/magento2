<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
 namespace Topefekt\Magesms\Controller\Adminhtml\Wizard; class Edit extends \Topefekt\Magesms\Controller\Adminhtml\Wizard { public function execute() { $ia118aa93019887b74fdff43dbcf59dce271cae7d = $this->getRequest()->getParam('country'); $i30f20aafde612a957f7f966cb5b85e35782bc88a = $this->getRequest()->getParam('type'); $i4d3f3bffcd16d5910b26a4511d33ad3b5e4c61d4 = true; if ($ia118aa93019887b74fdff43dbcf59dce271cae7d && $i30f20aafde612a957f7f966cb5b85e35782bc88a) { $i037b855bc01175f2c77d5c3e19eda9a0003feff4 = $this->getCountryFactory()->create()->getCollection(); $i037b855bc01175f2c77d5c3e19eda9a0003feff4->addFieldToFilter('name', $ia118aa93019887b74fdff43dbcf59dce271cae7d); if ($i037b855bc01175f2c77d5c3e19eda9a0003feff4->count()) { $this->getCoreRegistry()->register('country_name', $i037b855bc01175f2c77d5c3e19eda9a0003feff4->getFirstItem()->getName()); $this->getCoreRegistry()->register('country_area', $i037b855bc01175f2c77d5c3e19eda9a0003feff4->getFirstItem()->getArea()); $ia61712c27ea241bd7a543dc2b02ea572274d0322 = 'action=dostnew&username='.urlencode($this->profile->user->getUser()).'&password='.urlencode($this->profile->user->getPasswd()). '&area='.urlencode($i037b855bc01175f2c77d5c3e19eda9a0003feff4->getFirstItem()->getArea()).'&currency='.urlencode($this->profile->currency); $i55dd4e7042a1f9031b84f07f04c37165ce3d0720 = $this->getApi()->serverPost($ia61712c27ea241bd7a543dc2b02ea572274d0322); if ($i55dd4e7042a1f9031b84f07f04c37165ce3d0720['errno'] == 1 && !empty($i55dd4e7042a1f9031b84f07f04c37165ce3d0720['data'])) { $ice10b700e3771fcda63608142bce93b608228583 = $this->getRoutes(); $ice10b700e3771fcda63608142bce93b608228583->setInfo($i55dd4e7042a1f9031b84f07f04c37165ce3d0720['datasrc']); $ice10b700e3771fcda63608142bce93b608228583->setArea($i037b855bc01175f2c77d5c3e19eda9a0003feff4->getFirstItem()->getArea()); $ice10b700e3771fcda63608142bce93b608228583->setType($i30f20aafde612a957f7f966cb5b85e35782bc88a); $ice10b700e3771fcda63608142bce93b608228583->setAreaText($ia118aa93019887b74fdff43dbcf59dce271cae7d); $this->getCoreRegistry()->register('route', $ice10b700e3771fcda63608142bce93b608228583); } else { $i4d3f3bffcd16d5910b26a4511d33ad3b5e4c61d4 = false; } } else { $i4d3f3bffcd16d5910b26a4511d33ad3b5e4c61d4 = false; } } if ($i4d3f3bffcd16d5910b26a4511d33ad3b5e4c61d4) { if ($i7d411c0cc32cdb65ec82b9e8d79aa996946f5538 = $this->getRequest()->getParam('id')) { $ice10b700e3771fcda63608142bce93b608228583 = $this->getRoutes()->load($i7d411c0cc32cdb65ec82b9e8d79aa996946f5538); $this->getCoreRegistry()->register('route', $ice10b700e3771fcda63608142bce93b608228583); $this->getCoreRegistry()->register('country_name', $ice10b700e3771fcda63608142bce93b608228583->getAreaText()); $this->getCoreRegistry()->register('country_area', $ice10b700e3771fcda63608142bce93b608228583->getArea()); } $i195899c9895b81b9bc75dba762c949638a6f36dd = $this->getCountryFactory()->create()->getCollection(); $i195899c9895b81b9bc75dba762c949638a6f36dd->setOrder('name', 'ASC'); $this->getCoreRegistry()->register('countries', $i195899c9895b81b9bc75dba762c949638a6f36dd); $this->_initAction(); $this->_view->getPage()->getConfig()->getTitle()->prepend(__('SMS Settings')); $this->_view->renderLayout(); return; } $this->getMessageManager()->addErrorMessage(__('Unable to find a Route to load.')); $this->_redirect('*/*/'); } public function _initAction() { parent::_initAction(); $this->_addBreadcrumb(__('SMS Settings'), __('SMS Settings')); return $this; } } 