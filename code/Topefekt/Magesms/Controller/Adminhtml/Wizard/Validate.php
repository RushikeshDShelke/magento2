<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
 namespace Topefekt\Magesms\Controller\Adminhtml\Wizard; use Magento\Backend\App\Action\Context; use Magento\Framework\DataObject; use Magento\Framework\Registry; use Magento\Framework\View\Result\PageFactory; use Magento\Framework\Controller\Result\JsonFactory; use Topefekt\Magesms\Helper\Data; use Topefekt\Magesms\Model\Api; use Topefekt\Magesms\Model\CountryFactory; use Topefekt\Magesms\Model\Ownnumbersender; use Topefekt\Magesms\Model\Routes; use Topefekt\Magesms\Model\Smsprofile; use Topefekt\Magesms\Model\Textsender; class Validate extends \Topefekt\Magesms\Controller\Adminhtml\Wizard { protected $resultJsonFactory; public function __construct(Context $i31cc913adc2717e2346d503153c97449098831aa, PageFactory $i3f1db03e4dfdd28ff5ba1a1f709c3a2e135b99b1, Smsprofile $i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18, Api $i451f679eaafeecb81387b150019f0d9e0fa83d16, Data $i0d09b2a4f282150bf47b02f9f3d82586fe313844, Registry $ie9fe5cdc9fc7093987f4d41ad4cae3554e64e17b, CountryFactory $i037b855bc01175f2c77d5c3e19eda9a0003feff4, Routes $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec, Ownnumbersender $i1ad1e2c93d17b0cc1f975eb7f24bf76446264c6f, Textsender $i340682ca0ed5a64e8ea449191da847abaf0aec6f, JsonFactory $i62e47f1622e42a21f634db5e492d7fe7f7a85d54) { parent::__construct($i31cc913adc2717e2346d503153c97449098831aa, $i3f1db03e4dfdd28ff5ba1a1f709c3a2e135b99b1, $i6abff7c4dab2aa28578ae1dc49699ba6b1d18c18, $i451f679eaafeecb81387b150019f0d9e0fa83d16, $i0d09b2a4f282150bf47b02f9f3d82586fe313844, $ie9fe5cdc9fc7093987f4d41ad4cae3554e64e17b, $i037b855bc01175f2c77d5c3e19eda9a0003feff4, $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec, $i1ad1e2c93d17b0cc1f975eb7f24bf76446264c6f, $i340682ca0ed5a64e8ea449191da847abaf0aec6f); $this->resultJsonFactory = $i62e47f1622e42a21f634db5e492d7fe7f7a85d54; } public function execute() { $ia1a238c1f12f3901520c7ca55efa646e471f7f6e = new DataObject(); $ia1a238c1f12f3901520c7ca55efa646e471f7f6e->setError(false); if (!$this->getRequest()->getPost()) { $ia1a238c1f12f3901520c7ca55efa646e471f7f6e->setError(true); return $this->resultJsonFactory->create()->setData($ia1a238c1f12f3901520c7ca55efa646e471f7f6e); } $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec = $this->getRoutes(); $i7d411c0cc32cdb65ec82b9e8d79aa996946f5538 = (int)$this->getRequest()->getParam('id'); if ($i7d411c0cc32cdb65ec82b9e8d79aa996946f5538 > 0) { $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->load($i7d411c0cc32cdb65ec82b9e8d79aa996946f5538); } else { $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->setArea($this->getRequest()->getParam('area')); $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->setAreaText($this->getRequest()->getParam('country')); $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->setType($this->getRequest()->getParam('type')); } $iecc25823227283479c5811005734b6ee2bd56071 = explode(';', $this->getRequest()->getParam('isms')); if (isset($iecc25823227283479c5811005734b6ee2bd56071[0])) $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->setIsms($iecc25823227283479c5811005734b6ee2bd56071[0]); if (isset($iecc25823227283479c5811005734b6ee2bd56071[1])) $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->setSendertype($iecc25823227283479c5811005734b6ee2bd56071[1]); $ibdd27a8dd714410289189d318feb96fe6ed8e07f = $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->validate(); if (is_array($ibdd27a8dd714410289189d318feb96fe6ed8e07f)) { $ia1a238c1f12f3901520c7ca55efa646e471f7f6e->setError(true); $ia1a238c1f12f3901520c7ca55efa646e471f7f6e->setMessage(implode(' ', $ibdd27a8dd714410289189d318feb96fe6ed8e07f)); return $this->resultJsonFactory->create()->setData($ia1a238c1f12f3901520c7ca55efa646e471f7f6e); } if ($ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->getSendertype() == $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec::SENDER_SYSTEM || $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->getSendertype() == $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec::SENDER_SIM || $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->getSendertype() == $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec::SENDER_SHORTCODE) { $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->setSenderId(''); $ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->save(); $this->getSession()->unsRoutes(); $this->getSession()->setRouteSuccess($ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->getAreaText()); } else { $this->getSession()->setRoutes($ie8b7b1b62dc29a284d794c9f11a8ee2ea7472eec->getData()); } return $this->resultJsonFactory->create()->setData($ia1a238c1f12f3901520c7ca55efa646e471f7f6e); } } 