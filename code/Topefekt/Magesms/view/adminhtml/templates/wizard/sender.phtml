<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
?><?php $routes = $block->getRoutes(); ?><div class="messages"></div><div id="magesms"><div class="entry-edit"><div class="entry-edit-head"><h4 class="icon-head fieldset-legend head-account"><img src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/AdminTools.gif'); ?>" alt="" /><?php if ($routes->getSendertype() == $routes::SENDER_TEXT): ?><?php echo __('Text sender ID settings'); ?><?php else: ?><?php echo __('Own number sender ID settings'); ?><?php endif; ?></h4></div><fieldset class="fieldset grid"><form id="magesms_sender" data-mage-init='{"validation": {"validationUrl": "<?php echo $block->getUrl('*/*/sender_validate'); ?>"}}' action="<?php echo $block->getUrl('*/*/sender_save') ?>" method="post" onkeypress="return event.keyCode != 13;"><?php echo $block->getBlockHtml('formkey') ?><?php if ($routes->getSendertype() == $routes::SENDER_TEXT): ?><?php $senders = $block->getTextsender()->getCollection(); $prefix = ''; $first = __('Text sender ID'); $label1 = __('Existing Text sender ID:'); $label2 = __('New Text sender ID:'); $maxlength = $block->getOwnnumbersender()::MAX_LENGTH; $desc = __('max. 11 characters'); ?><?php else: ?><?php $senders = $block->getOwnnumbersender()->getCollection(); $prefix = '+'; $first = __('Own number sender ID'); $label1 = __('Existing Own number:'); $label2 = __('New Own number sender ID:'); $maxlength = $block->getTextsender()::MAX_LENGTH; $desc = __('in international format, no leading <br />zeros or a “+” sign, e.g., 447971796595'); ?><?php endif; ?><?php if ($routes->displayCode === true): ?><div class="margin-form" id="senderx"><label class="form-required" for="newsender"><?php echo $label2; ?> <span class="required">*</span></label><?php echo $routes->getSenderId(); ?></div><div class="margin-form"><label class="form-required" for="code"><?php echo __('SMS code:'); ?> <span class="required">*</span></label><input class="required-entry validate-sender input-text admin__control-text" type="text" name="code" id="code" value="" /></div><?php else: ?><?php if ($senders->count()): ?><div class="margin-form"><label class="form-required" for="sender"><?php echo $label1; ?> <span class="required">*</span></label><select class="admin__control-select" name="sender" id="sender"><option value="">-><?php echo $first; ?></option><?php foreach($senders as $sender): ?><option value="<?php echo $sender->getVal(); ?>"><?php echo $prefix.$sender->getVal(); ?></option><?php endforeach; ?></select></div><?php endif; ?><div class="margin-form" id="senderx"><label class="form-required" for="newsender"><?php echo $label2; ?> <span class="required">*</span></label><input class="required-entry validate-sender input-text admin__control-text" maxlength="<?php echo $maxlength; ?>" type="text" name="newsender" id="newsender" value="" /><p><?php echo $desc; ?></p></div><?php endif; ?><div class="margin-form"><button id="submitLogin" name="submitSend" title="<?php echo $block->escapeHtml(__('CONFIRM')); ?>" type="submit" class="primary" role="button" aria-disabled="false"><span class="ui-button-text"><span><?php echo $block->escapeHtml(__('CONFIRM')); ?></span></span></button></div></form></fieldset></div></div><script type="text/javascript">//<![CDATA[
require(['jquery','jquery/ui','jquery/validate'], function($) {$(document).ready(function () {$('#sender').change(function () {if (this.value) {$('#senderx').hide();$(this).addClass('required-entry');$('#newsender').removeClass('required-entry')$('#newsender').removeClass('validate-sender')} else {$('#senderx').show();$(this).removeClass('required-entry');$('#newsender').addClass('required-entry')$('#newsender').addClass('validate-sender')}});});<?php if ($routes->getSendertype() == $routes::SENDER_TEXT): ?>$.validator.addMethod('validate-sender', function (v) {return v.length >= 3 && /^[0-9a-zA-Z_.]+$/.test(v) && !/^[0-9]+$/.test(v);}, '<?php echo __('possible characters: ').'a-z A-Z 0-9 _ .'; ?>');<?php else: ?>$.validator.addMethod('validate-sender', function (v) {return v.length && /^[1-9]+[0-9]+$/.test(v);}, '<?php echo __('own number sender ID must be number'); ?>');<?php endif; ?>});
//]]></script>