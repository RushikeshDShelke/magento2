<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
?><?php $currency = $block->profile->currency; if ($routes = $block->getRoutes()): $id = $block->getRequest()->getParam('id', null); $info = $routes[0]->getInfo(); ?><table cellspacing="0" class="data-grid"><tr><th rowspan="2" class="data-grid-th"><?php echo __('SENDER TYPE'); ?></th><th rowspan="2" class="data-grid-th"><?php echo __('NETWORK'); ?></th><th colspan="3" class="data-grid-th"><?php printf(__('SMS PRICE IN %s (excl. VAT)'), $currency); ?></th><th rowspan="2" class="data-grid-th"><?php echo __('SMS PRICE<br />IN CREDITS'); ?></th><th rowspan="2" class="data-grid-th"><?php echo __('Unicode'); ?> &nbsp;<span onclick="popup_title(this)" title="<?php echo __('Unicode characters support (Unicode allows you to enter characters in all fonts and various symbols simultaneously. Is used for Chinese, Arabic, Greek, Hebrew, Korean, Cyrillic, etc. or diacritic in the text of your SMS message)'); ?>" style="cursor:help;text-decoration:underline;">?</span></th></tr><tr><th class="data-grid-th"><?php echo __('payment'); ?> <?php echo $info['payment'][0][0]; ?> (<?php echo $currency; ?>)</th><th class="data-grid-th"><?php echo $info['payment'][1][0]; ?> (<?php echo $currency; ?>)</th><th class="data-grid-th"><?php echo $info['payment'][2][0]; ?> (<?php echo $currency; ?>)</th></tr><?php foreach($routes as $route): ?><?php if ($id === null && $route->getId()): ?><tr style="border-top:1px solid"><td><?php echo $route->getAreaText(); ?> (+<?php echo $route->getArea(); ?>)</td><td colspan="6"><a href="<?php echo $block->getUrl('*/*/edit', ['country' => $route->getAreaText(), 'id' => $route->getId()]); ?>"><img title="edit <?php echo $route->getAreaText(); ?>" alt="edit <?php echo $route->getAreaText(); ?>" style="border:0px;" name="submitAddAdmin" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/edit.gif'); ?>"></a><a href="<?php echo $block->getUrl('*/*/delete', ['id' => $route->getId()]); ?>" onclick="return confirm('<?php echo __('Are you sure to delete').' '.$route->getAreaText().'?'; ?>')"><img title="delete <?php echo $route->getAreaText(); ?>" alt="delete <?php echo $route->getAreaText(); ?>" style="border:0px;" name="submitAddAdmin" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/delete.gif'); ?>"></a></td></tr><?php endif; ?><?php $info = $route->getInfo(); foreach($info['sms'] as $sendertype => $gates): $_sender = array_values(array_values($gates)[0])[0]['sender']; switch($sendertype) { case \Topefekt\Magesms\Model\Routes::SENDER_TEXT: $sender_h = __('TEXT SENDER ID'); if (!$id && $route->getSenderId()) { $add = '<b>'.$route->getSenderId().'</b>'; if ($route->getAlternatives()) { foreach($route->getAlternatives() as $alternative) $add .= ', '.$alternative->getTextsender(); } } else { $add = __('e.g.:').' myweb.com'; } $pozn = "<span style=\"font-size:10px;\">&nbsp;&nbsp;- ".$add."</span>"; break; case \Topefekt\Magesms\Model\Routes::SENDER_SYSTEM: $sender_h = __('SYSTEM NUMBER'); $pozn = "<span style=\"font-size:10px;\">&nbsp;&nbsp;- ".__('e.g.:').($_sender ? " $_sender" : ' +420602123456').'</span>'; break; case \Topefekt\Magesms\Model\Routes::SENDER_SHORTCODE: $sender_h = __('SHORTCODE'); $pozn = "<span style=\"font-size:10px;\">&nbsp;&nbsp;- SenderID: ".($_sender ? $_sender : (__('e.g.:').' 12345')).'</span>'; break; case \Topefekt\Magesms\Model\Routes::SENDER_OWN: $sender_h = __('OWN NUMBER SENDER ID'); if (!$id && $route->getSenderId()) $add = '<b>+'.$route->getSenderId().'</b>'; else $add = __('e.g.:').' +447971796595'; $pozn = "<span style=\"font-size:10px;\">&nbsp;&nbsp;- ".$add."</span>"; break; case \Topefekt\Magesms\Model\Routes::SENDER_SIM: $sender_h = __('SIM HOSTING'); $pozn = ''; break; } ?><?php foreach($gates as $gate => $networks): ?><?php if ($id === null && $route->getId() ) { if ($route->getIsms() != $gate || $route->getSendertype() != $sendertype ) continue; } $prid = ''; if ($sendertype == 3) $prid = ' ('.$gate.')'; $virtuals = false; ?><?php $even = 0; foreach($networks as $network => $price): $even++; if ($price['virtual']) {$virtuals = true;} ?><tr class="<?php echo $price['virtual']?('virtual'.$route->getArea().$gate.' hidden '):''?><?php if (!($even % 2)) { echo 'even'; } ?>" style="<?php echo $even == 1?'border-top:1px solid #c6c6c6':'' ?>"><td><?php if ($even == 1): ?><?php if ($id !== null || !$route->getId()): ?><input type="radio" name="isms" class="admin__control-radio" id="isms_<?php echo $gate.'_'.$sendertype; ?>" value="<?php echo $gate.';'.$sendertype; ?>" <?php echo $route->getIsms() == $gate && $route->getSendertype() == $sendertype ? 'checked' : ''; ?> /><label for="isms_<?php echo $gate.'_'.$sendertype; ?>"><?php echo $sender_h.$prid.$pozn; ?></label><?php else: ?><?php echo $sender_h.$prid.$pozn; ?><?php endif; ?><?php endif; ?></td><td><?php echo $network; ?></td><td class="a-center"><?php echo $block->getMageHelper()->formatPrice($price['pay1']); ?></td><td class="a-center"><?php echo $block->getMageHelper()->formatPrice($price['pay2']); ?></td><td class="a-center"><?php echo $block->getMageHelper()->formatPrice($price['pay3']); ?></td><td class="a-center"><?php echo $block->getMageHelper()->formatPrice($price['credit'], 2); ?></td><td class="a-center"><?php if ($price['unicode'] > 0): ?><img alt="<?php echo __('UNICODE SUPPORTED'); ?>" style="border:0px" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/i_accepted.gif'); ?>"><?php else: ?><img alt="<?php echo __('UNICODE UNSUPPORTED'); ?>" style="border:0px" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/i_canceled.gif'); ?>"><?php endif; ?></td></tr><?php endforeach; ?><?php if ($virtuals): ?><tr class="<?php if ($even % 2) { echo 'even'; $even++; } else { $even++; } ?>"><?php $even++;?><td></td><td colspan="6"><a href="#" onclick="virtuals('virtual<?php echo $route->getArea().$gate;?>');return false;"><?php echo __('Virtual operators (MVNO)'); ?></a></td></tr><?php endif; ?><?php endforeach; ?><?php endforeach; ?><?php endforeach; ?></table><?php endif; ?>