<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
?><?php $user = $block->profile->user; $lang = $block->profile->lang; ?><p><?php echo __('Select events during which shall be customer notified via SMS and customize text of messages. You can also add a new language version of SMS messages for each country separately. In countries with undefined language version will be used default language version.'); ?></p><div id="magesms"><div class="entry-edit"><div class="entry-edit-head"><h4 class="icon-head fieldset-legend head-account"><img src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/translation.gif'); ?>" alt="" /> <?php echo __(' language version'); ?></h4></div><fieldset class="fieldset grid"><ul class="mutations"><?php foreach ($block->getMutations() as $mutation): ?><li <?php if ($mutation['selected']): ?>class="active"<?php endif; ?>><a href="<?php echo $block->getUrl('*/*/', array('mutation' => $mutation['value'])); ?>" title="<?php echo implode("\n", $mutation['stores']); ?>"><?php echo $mutation['label']?></a></li><?php endforeach; ?></ul><div class="clear"></div></fieldset></div><div class="entry-edit"><div class="entry-edit-head"><h4 class="icon-head fieldset-legend head-account"><img src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/AdminTools.gif'); ?>" alt="" /> <?php echo __('Unicode SMS'); ?></h4></div><fieldset class="fieldset grid"><form id="magesms_changeunicode" action="<?php echo $block->getUrl('*/*/unicode_save') ?>" method="post"><?php echo $block->getBlockHtml('formkey') ?><div class="margin-form"><p><?php echo __('Check only if you want to use Chinese, Arabic, Greek, Hebrew, Korean, Cyrillic, etc. or diacritic in the text of your SMS message (Unicode text allows you to insert characters in all fonts and various other symbols simultaneously. Number of characters in one SMS will be reduced to 70).'); ?></p><input type="hidden" name="mutation" value="<?php echo $this->getMutationValue(); ?>" /><input type="checkbox" id="unicode" name="unicode" class="admin__control-checkbox" value="1" <?php echo ($unicode = $block->getUnicode()->getUnicode()) ? 'checked' : ''; ?> /><label for="unicode"><?php echo __('Unicode SMS'); ?></label><button id="submit" name="submit" title="<?php echo $block->escapeHtml(__('Save')); ?>" type="submit" class="primary" role="button" aria-disabled="false"><span class="ui-button-text"><span><?php echo $block->escapeHtml(__('Save')); ?></span></span></button></div></form></fieldset></div><?php foreach ($block->getGroups() as $group): ?><div class="entry-edit"><div class="entry-edit-head"><h4 class="icon-head fieldset-legend head-account"><?php if ($group->getIcon()): ?><img src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::'.$group->getIcon()); ?>" alt="" /> <?php endif; ?><?php echo __($group->getName()); ?></h4></div><fieldset class="fieldset grid admin__data-grid-wrap admin__data-grid-wrap-static"><?php if (count($group->getHooks())): ?><table class="data-grid" id="gridData"><col /><col width="100px" /><?php $even = 1; foreach($group->getHooks() as $hook): if ($even) $even = 0; else $even = 1; ?><tr id="hist_<?php echo $hook->getName(); ?>" class="_clickable hover <?php if (!$even) echo 'even'?>"><td><span class="img"><img class="toggle" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/i_plus.gif'); ?>"></span><span class="img" style="display:none"><img class="toggle" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/i_minus.gif'); ?>"></span><?php if (!$group->getGroup()): ?><?php echo $hook->getInfo(); ?> - <?php echo $statusT = __($hook->getStatusName()); ?><?php if ($statusT != $hook->getStatusName()): ?> (<?php echo $hook->getStatusName(); ?>)<?php endif; ?><?php else: ?><?php echo $hook->getName(); ?> - <?php echo $hook->getInfo(); ?><?php endif; ?></td><td class="a-center"><?php $title = $hook->getActive() ? __('Sending notifications via SMS is ACTIVE') : __('Sending notifications via SMS is NOT ACTIVE. To activate SMS sending check „Active“ in desired status detail.'); $img = $hook->getActive() ? 'i_accepted.gif' : 'i_canceled.gif'; ?><span style="cursor:help;" title="<?php echo $title; ?>" onclick="popup_title(this)"><img class="toggle" src="<?php echo $block->getViewFileUrl('Topefekt_Magesms::images/'.$img); ?>"></span></td></tr><tr id="histd_<?php echo $hook->getName(); ?>" style="display:none"><td colspan="2"><form id="hook_<?php echo $hook->getName(); ?>" action="<?php echo $block->getUrl('*/*/save') ?>" method="post"><?php echo $block->getBlockHtml('formkey') ?><input type="hidden" name="type" value="customers" /><input type="hidden" name="name" value="<?php echo $hook->getName(); ?>" /><input type="hidden" name="mutation" value="<?php echo $this->getMutationValue(); ?>" /><?php if ($hook->getPlugin()): ?><input type="hidden" name="plugin" value="<?php echo $hook->getPlugin(); ?>" /><?php endif; ?><div style="display:inline-block;width:350px;"><label style="font-weight:normal;text-align:left;width:350px;"><?php echo __('SMS text'); ?></label><br><textarea id="text_<?php echo $hook->getName(); ?>" name="text" class="required-entry input-text" style="width:290px;height:100px;border:1px solid grey;"><?php echo ($text = $hook->getSmstext()) ? $text : $hook->getTemplateCustomer(); ?></textarea></div><div style="display:inline-block;width:320px;"><label style="font-weight:normal;text-align:left"><?php echo __('Preview'); ?> (<span id="label_<?php echo $hook->getName(); ?>"></span>)</label><br><textarea id="textfake_<?php echo $hook->getName(); ?>" name="textfake" disabled="disabled" style="width:290px;height:100px;border:1px solid grey;"></textarea></div><div style="display:inline-block;width:310px; padding-top: 20px;"><?php if (!$hook->getHideActive()): ?><?php echo __('Active'); ?><br /><br /><input type="checkbox" name="active" class="admin__control-checkbox" id="active_<?php echo $hook->getName(); ?>" value="1" <?php echo $hook->getActive() ? 'checked' : ''; ?> /><label for="active_<?php echo $hook->getName(); ?>"><?php echo __('Active'); ?></label><?php endif;?><?php if ($hook->getCustomForm2()): ?><?php echo $hook->getCustomForm2();?><?php endif; ?><br /><br /><br /><div style="float:left;"><button id="submit" name="submit" title="<?php echo $block->escapeHtml(__('Save')); ?>" type="submit" class="primary" role="button" aria-disabled="false"><span class="ui-button-text"><span><?php echo $block->escapeHtml(__('Save')); ?></span></span></button></div><div style="float:left;padding-left:20px;"><button id="submit" name="submit" title="<?php echo $block->escapeHtml(__('Restore unsaved changes to its original state.')); ?>" type="button" class="" role="button" onclick="this.form.reset();countitSMS_<?php echo $hook->getName(); ?>.count();" aria-disabled="false"><span class="ui-button-text"><span><?php echo $block->escapeHtml(__('Cancel')); ?></span></span></button></div></div></form><script type="text/javascript">//<![CDATA[
countitSMS_<?php echo $hook->getName(); ?> = new countitSMS(document.getElementById('textfake_<?php echo $hook->getName(); ?>'), '<?php echo $unicode; ?>', document.getElementById('label_<?php echo $hook->getName(); ?>'));countitSMS_<?php echo $hook->getName(); ?>.chartext1 = '<?php echo __('Characters: '); ?>';countitSMS_<?php echo $hook->getName(); ?>.chartext2 = '<?php echo __('total sms:'); ?>';countitSMS_<?php echo $hook->getName(); ?>.alert = '';countitSMS_<?php echo $hook->getName(); ?>.translate = {<?php echo $block->getMageHelper()->hookVariablesJS($hook->getNotice()); ?>};countitSMS_<?php echo $hook->getName(); ?>.copyFrom = document.getElementById('text_<?php echo $hook->getName(); ?>');document.getElementById('text_<?php echo $hook->getName(); ?>').onkeyup = function() {countitSMS_<?php echo $hook->getName(); ?>.count();};require(['jquery',], function($) {$(document).ready(function () {countitSMS_<?php echo $hook->getName(); ?>.count();countitSMS_<?php echo $hook->getName(); ?>.help(document.getElementById('notice_<?php echo $hook->getName(); ?>'));});});
//]]></script><div class="clear"></div><span style="font-size:10px;"><?php echo __('Possible variables:'); ?><br /><div id="notice_<?php echo $hook->getName(); ?>"><?php echo $hook->getNotice(); ?></div></span></td></tr><?php endforeach; ?></table><?php endif; ?></fieldset></div><?php endforeach; ?><script type="text/javascript">//<![CDATA[
require(['jquery',], function($) {$(document).ready(function () {var gridData = document.getElementById('magesms');var tr_array = gridData.getElementsByTagName('tr');for (var i=0, len=tr_array.length; i < len; i++) {if (tr_array[i].className.indexOf('hover') !== -1) {tr_array[i].onmouseover = function() {this.className = this.className + ' on-mouse';};tr_array[i].onmouseout = function() {this.className = this.className.replace(' on-mouse', '');};tr_array[i].onclick = function() {var arr = this.id.split('_');var next = document.getElementById('histd_'+arr[1]);if (next.style.display == 'none') {next.style.display = 'table-row';} else {next.style.display = 'none';}var img = this.getElementsByClassName('img');if (img[0].style.display == 'none') {img[0].style.display = 'inline';} else {img[0].style.display = 'none';}if (img[1].style.display == 'none') {img[1].style.display = 'inline';} else {img[1].style.display = 'none';}};}}if (window.location.hash.substr(1)) {$('#hist_' + window.location.hash.substr(1)).click();$('#hist_' + window.location.hash.substr(1))[0].scrollIntoView({behavior: "smooth", block: "start"});var messageTo = $('#hook_' + window.location.hash.substr(1));$('#messages').clone().prependTo(messageTo);}});});
//]]></script></div>